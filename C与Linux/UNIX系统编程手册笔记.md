## 第3章 系统编程概念
#### 3.1 系统调用
系统调用是受控的内核入口。借助这一机制，进程可以请求内核以自己的名义去执行某些动作。以应用程序编程接口（API）的形式，内核提供了一系列服务供程序访问。这包括创建新进程、执行I/O，以及为进程间通信创建管道等。执行步骤如下：
1. 应用程序通过调用C语言函数库的外壳（wrapper）函数，来发起系统调用
2. 外壳函数将参数复制到寄存器
3. 所有系统调用进入内核的方式相同，因此内核用系统调用编号区分每个系统调用。因此，外壳函数会将系统调用编号复制到一个特殊的CPU寄存器（%eax）中
4. 外壳函数执行一条中断机器指令（int 0x80），引发处理器从用户态切换到内核态，并执行系统中断0x80的中断矢量所指向的代码。（较新硬件平台实现了sysenter指令，比int 0x80更快）
5. 为响应中断0x80，内核会调用system_call例程来处理此次中断。大致过程是执行系统调用编号对应的服务例程，服务例程将结果返回给system_call()例程，再返回至外壳函数，同时将处理器切换回用户态。

从C语言编程的角度来看，调用C语言函数库的外壳函数等同于调用相应的系统调用服务例程。
> 所有系统调用都是以原子操作方式执行的。

#### 3.2 库函数
许多库函数不会使用任何系统调用，如字符串操作函数；有些库函数构建于系统调用之上。例如函数库fopen()就利用系统调用open()来执行实际的文件打开操作。设计函数库是为了提供比底层系统调用更为方便的调用接口。

## 第4章 文件I/O：通用的I/O模型
#### 4.1 概述
所有执行I/O操作的系统调用都以文件描述符，一个非负整数来指代打开的文件。文件描述符用以表示所有类型的已打开的文件，包括管道、FIFO、socket、终端、设备和普通文件。
|文件描述符|用途|POSIX名称|stdio流|
|--------|--------|--------|--------|
|0|标准输入|STDIN_FILENO|stdin|
|1|标准输出|STDOUT_FILENO|stdout|
|2|标准错误|STDERR_FILENO|stderr|


## 第6章 进程
从内核角度看，进程由用户内存空间和一系列内核数据结构组成，其中用户内存空间包含了程序代码及代码使用的变量，而内核数据结构则用于维护进程状态信息。记录在内核数据结构中的信息包括许多与进程相关的标识号、虚拟内存表、打开文件的描述符表、信号传递及处理的有关信息、进程资源使用及限制、当前工作目录和大量的其他信息。