# 1.概述
运输层的主要协议：
1. 用户数据报协议UDP（User Datagram Protocol）
2. 传输控制协议TCP（Transmission Control Protocol）

![TCP/IP体系中的运输层协议](https://upload-images.jianshu.io/upload_images/3468445-f07a951524522a49.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

&emsp;&emsp;UDP在传输数据前不需要先建立连接。
&emsp;&emsp;TCP则提供面向连接的服务。

TCP/IP的运输层用一个16位**端口号**来标志一个端口，端口号只具有本地意义。**服务端使用的端口号** 0~49151，**客户端使用的端口号** 49152~65535 仅在客户进程运行时动态选择。

# 2.TCP
套接字 socket = (IP 地址：端口号)
### 2.1 可靠传输的原理
#### 2.1.1 停止等待协议
每发送完一个数据单元就停止发送，等待对方的确认，在收到确认后再发送下一个数据单元。

#### 2.1.2 滑动窗口协议
由于停止等待协议的信道利用率太低

#### 三次握手
三次握手一是确认双方的收发消息能力，二是各自的状态改变和相应的资源开辟。内核提供的Socket API就是对开辟的资源的操作，开辟的资源主要就是数据缓存，

四次挥手，如果中途突然断网，内核有心跳包

# 3.Socket
使用Socket通信，客户端和服务端会建立连接，类似建立一个通道，然后客户端写数据，服务端读数据。如果客户端写数据，服务端没有读或者读得慢，那么客户端只要写入超过了可以缓存的大小，就无法再写入，此时写入会阻塞，等到服务端读取了数据后，客户端才能继续写入。